LINUXï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼š

# åˆ›å»ºæ–‡ä»¶
cat > sample.txt

# åˆ›å»ºç›®å½•å’Œçˆ¶ç›®å½• a,b,c,d
mkdir -p a/b/c/d ä¸€ä¸ªä¸ªå±‚çº§çš„ç›®å½•

# æ‹·è´æ–‡ä»¶å¤¹ a åˆ°/tmp ç›®å½•
cp -rvf a/ /tmp/

pwd å‘½ä»¤èƒ½å¤Ÿçœ‹åˆ°å½“å‰ç»ˆç«¯æ‰€åœ¨çš„ç›®å½•
diff å‘½ä»¤ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦çš„å·®å¼‚

# å‹ç¼©
tar -cvf test.tar a å°†æ–‡ä»¶ a æ‰“åŒ…ä¸º test.tar
tar -zcvf test.tar.gz a æ‰“åŒ…å¹¶ gzip å‹ç¼©ã€‚ #è§£å‹
tar xvf test.tar


ä¸Šä¼ æ–‡ä»¶
scp -r dist  sur@47.93.20.245:/opt/web/nginx/html 

æ”¹æ–‡ä»¶å¤¹åç§°



# Nginxï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼š
Nginx æ˜¯å¼€æºã€é«˜æ€§èƒ½ã€é«˜å¯é çš„ Web å’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œè€Œä¸”æ”¯æŒçƒ­éƒ¨ç½²ï¼Œå‡ ä¹å¯ä»¥åšåˆ° 7 \* 24 å°æ—¶ä¸é—´æ–­è¿è¡Œï¼Œ
å³ä½¿è¿è¡Œå‡ ä¸ªæœˆä¹Ÿä¸éœ€è¦é‡æ–°å¯åŠ¨ï¼Œè¿˜èƒ½åœ¨ä¸é—´æ–­æœåŠ¡çš„æƒ…å†µä¸‹å¯¹è½¯ä»¶ç‰ˆæœ¬è¿›è¡Œçƒ­æ›´æ–°ã€‚æ€§èƒ½æ˜¯ Nginx æœ€é‡è¦çš„è€ƒé‡ï¼Œå…¶å ç”¨å†…å­˜å°‘ã€å¹¶å‘èƒ½åŠ›å¼ºã€èƒ½æ”¯æŒé«˜è¾¾ 5w ä¸ªå¹¶å‘è¿æ¥æ•°ï¼Œ
æœ€é‡è¦çš„æ˜¯ï¼ŒNginx æ˜¯å…è´¹çš„å¹¶å¯ä»¥å•†ä¸šåŒ–ï¼Œé…ç½®ä½¿ç”¨ä¹Ÿæ¯”è¾ƒç®€å•ã€‚

Nginx çš„æœ€é‡è¦çš„å‡ ä¸ªä½¿ç”¨åœºæ™¯ï¼š
é™æ€èµ„æºæœåŠ¡ï¼Œé€šè¿‡æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæä¾›æœåŠ¡ï¼›
åå‘ä»£ç†æœåŠ¡ï¼Œå»¶ä¼¸å‡ºåŒ…æ‹¬ç¼“å­˜ã€è´Ÿè½½å‡è¡¡ç­‰ï¼›
API æœåŠ¡,OpenResty

æ­£å‘ä»£ç†ï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼š
ä¸€èˆ¬çš„è®¿é—®æµç¨‹æ˜¯å®¢æˆ·ç«¯ç›´æ¥å‘ç›®æ ‡æœåŠ¡å™¨å‘é€è¯·æ±‚å¹¶è·å–å†…å®¹ï¼Œä½¿ç”¨æ­£å‘ä»£ç†åï¼Œå®¢æˆ·ç«¯æ”¹ä¸ºå‘ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¹¶æŒ‡å®šç›®æ ‡æœåŠ¡å™¨ï¼ˆåŸå§‹æœåŠ¡å™¨ï¼‰ï¼Œ
ç„¶åç”±ä»£ç†æœåŠ¡å™¨å’ŒåŸå§‹æœåŠ¡å™¨é€šä¿¡ï¼Œè½¬äº¤è¯·æ±‚å¹¶è·å¾—çš„å†…å®¹ï¼Œå†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚æ­£å‘ä»£ç†éšè—äº†çœŸå®çš„å®¢æˆ·ç«¯ï¼Œä¸ºå®¢æˆ·ç«¯æ”¶å‘è¯·æ±‚ï¼Œä½¿çœŸå®å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨ä¸å¯è§ï¼›
egï¼š ğŸŒ°ä½ çš„æµè§ˆå™¨æ— æ³•ç›´æ¥è®¿é—®è°·å“¥ï¼Œè¿™æ—¶å€™å¯ä»¥é€šè¿‡ä¸€ä¸ªä»£ç†æœåŠ¡å™¨æ¥å¸®åŠ©ä½ è®¿é—®è°·å“¥ï¼Œé‚£ä¹ˆè¿™ä¸ªæœåŠ¡å™¨å°±å«æ­£å‘ä»£ç†ã€‚

åå‘ä»£ç†ï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼š
ä¸ä¸€èˆ¬è®¿é—®æµç¨‹ç›¸æ¯”ï¼Œä½¿ç”¨åå‘ä»£ç†åï¼Œç›´æ¥æ”¶åˆ°è¯·æ±‚çš„æœåŠ¡å™¨æ˜¯ä»£ç†æœåŠ¡å™¨ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸ŠçœŸæ­£è¿›è¡Œå¤„ç†çš„æœåŠ¡å™¨ï¼Œå¾—åˆ°çš„ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚
åå‘ä»£ç†éšè—äº†çœŸå®çš„æœåŠ¡å™¨ï¼Œä¸ºæœåŠ¡å™¨æ”¶å‘è¯·æ±‚ï¼Œä½¿çœŸå®æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯ä¸å¯è§ã€‚ä¸€èˆ¬åœ¨å¤„ç†è·¨åŸŸè¯·æ±‚çš„æ—¶å€™æ¯”è¾ƒå¸¸ç”¨ã€‚ç°åœ¨åŸºæœ¬ä¸Šæ‰€æœ‰çš„å¤§å‹ç½‘ç«™éƒ½è®¾ç½®äº†åå‘ä»£ç†ã€‚
egï¼š ğŸŒ°å»é¥­åº—åƒé¥­ï¼Œå¯ä»¥ç‚¹å·èœã€ç²¤èœã€æ±Ÿæµ™èœï¼Œé¥­åº—ä¹Ÿåˆ†åˆ«æœ‰ä¸‰ä¸ªèœç³»çš„å¨å¸ˆ ğŸ‘¨â€ğŸ³ï¼Œä½†æ˜¯ä½ ä½œä¸ºé¡¾å®¢ä¸ç”¨ç®¡å“ªä¸ªå¨å¸ˆç»™ä½ åšçš„èœï¼Œ
åªç”¨ç‚¹èœå³å¯ï¼Œå°äºŒå°†ä½ èœå•ä¸­çš„èœåˆ†é…ç»™ä¸åŒçš„å¨å¸ˆæ¥å…·ä½“å¤„ç†ï¼Œé‚£ä¹ˆè¿™ä¸ªå°äºŒå°±æ˜¯åå‘ä»£ç†æœåŠ¡å™¨

è´Ÿè½½å‡è¡¡ï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼š
ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å‘é€å¤šä¸ªè¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†å¯èƒ½è¦æ“ä½œä¸€äº›èµ„æºæ¯”å¦‚æ•°æ®åº“ã€é™æ€èµ„æºç­‰ï¼ŒæœåŠ¡å™¨å¤„ç†å®Œæ¯•åï¼Œå†å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚
è¿™ç§æ¨¡å¼å¯¹äºæ—©æœŸçš„ç³»ç»Ÿæ¥è¯´ï¼ŒåŠŸèƒ½è¦æ±‚ä¸å¤æ‚ï¼Œä¸”å¹¶å‘è¯·æ±‚ç›¸å¯¹è¾ƒå°‘çš„æƒ…å†µä¸‹è¿˜èƒ½èƒœä»»ï¼Œæˆæœ¬ä¹Ÿä½ã€‚éšç€ä¿¡æ¯æ•°é‡ä¸æ–­å¢é•¿ï¼Œè®¿é—®é‡å’Œæ•°æ®é‡é£é€Ÿå¢é•¿ï¼Œä»¥åŠç³»ç»Ÿä¸šåŠ¡å¤æ‚åº¦æŒç»­å¢åŠ ï¼Œè¿™ç§åšæ³•å·²æ— æ³•æ»¡è¶³è¦æ±‚ï¼Œå¹¶å‘é‡ç‰¹åˆ«å¤§æ—¶ï¼ŒæœåŠ¡å™¨å®¹æ˜“å´©ã€‚
å¾ˆæ˜æ˜¾è¿™æ˜¯ç”±äºæœåŠ¡å™¨æ€§èƒ½çš„ç“¶é¢ˆé€ æˆçš„é—®é¢˜ï¼Œé™¤äº†å †æœºå™¨ä¹‹å¤–ï¼Œæœ€é‡è¦çš„åšæ³•å°±æ˜¯è´Ÿè½½å‡è¡¡ã€‚
è¯·æ±‚çˆ†å‘å¼å¢é•¿çš„æƒ…å†µä¸‹ï¼Œå•ä¸ªæœºå™¨æ€§èƒ½å†å¼ºåŠ²ä¹Ÿæ— æ³•æ»¡è¶³è¦æ±‚äº†ï¼Œè¿™ä¸ªæ—¶å€™é›†ç¾¤çš„æ¦‚å¿µäº§ç”Ÿäº†ï¼Œå•ä¸ªæœåŠ¡å™¨è§£å†³ä¸äº†çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œç„¶åå°†è¯·æ±‚åˆ†å‘åˆ°å„ä¸ªæœåŠ¡å™¨ä¸Šï¼Œå°†è´Ÿè½½åˆ†å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œè¿™å°±æ˜¯è´Ÿè½½å‡è¡¡ï¼Œæ ¸å¿ƒæ˜¯ã€Œåˆ†æ‘Šå‹åŠ›ã€ã€‚Nginx å®ç°è´Ÿè½½å‡è¡¡ï¼Œä¸€èˆ¬æ¥è¯´æŒ‡çš„æ˜¯å°†è¯·æ±‚è½¬å‘ç»™æœåŠ¡å™¨é›†ç¾¤ã€‚
egï¼š ğŸŒ°æ™šé«˜å³°ä¹˜ååœ°é“çš„æ—¶å€™ï¼Œå…¥ç«™å£ç»å¸¸ä¼šæœ‰åœ°é“å·¥ä½œäººå‘˜å¤§å–‡å­â€œè¯·èµ° B å£ï¼ŒB å£äººå°‘è½¦ç©º....â€ï¼Œè¿™ä¸ªå·¥ä½œäººå‘˜çš„ä½œç”¨å°±æ˜¯è´Ÿè½½å‡è¡¡ã€‚

åŠ¨é™åˆ†ç¦»:æœåŠ¡å™¨è®¿é—®é‡ç‰¹åˆ«å¤§çš„æ—¶å€™éœ€è¦è€ƒè™‘ cdn

nginx å®‰è£…--ä½¿ç”¨--é…ç½®ï¼š


é‡å¯nginx
nginx -s reload



Dockerï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼š
Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„é•œåƒä¸­ï¼Œ
ç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æˆ– Windows æ“ä½œç³»ç»Ÿçš„æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£
Docker ä½œä¸ºè½»é‡çº§è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œæ‹¥æœ‰æŒç»­é›†æˆã€ç‰ˆæœ¬æ§åˆ¶ã€å¯ç§»æ¤æ€§ã€éš”ç¦»æ€§å’Œå®‰å…¨æ€§ç­‰ä¼˜åŠ¿
Docker ä½¿ç”¨ Google å…¬å¸æ¨å‡ºçš„ Go è¯­è¨€ è¿›è¡Œå¼€å‘å®ç°ï¼ŒåŸºäº Linux å†…æ ¸ çš„ cgroup,namespace,ä»¥åŠ AUFS ç±»çš„ UnionFS ç­‰æŠ€æœ¯ï¼Œå¯¹è¿›ç¨‹è¿›è¡Œå°è£…éš”ç¦»ï¼Œå±äºæ“ä½œç³»ç»Ÿå±‚é¢çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚ ç”±äºéš”ç¦»çš„è¿›ç¨‹ç‹¬ç«‹äºå®¿ä¸»å’Œå…¶å®ƒçš„éš”ç¦»çš„è¿›
ç¨‹,å› æ­¤ä¹Ÿç§°å…¶ä¸ºå®¹å™¨ã€‚Docker æœ€åˆå®ç°æ˜¯åŸºäº LXC.
Docker èƒ½å¤Ÿè‡ªåŠ¨æ‰§è¡Œé‡å¤æ€§ä»»åŠ¡ï¼Œä¾‹å¦‚æ­å»ºå’Œé…ç½®å¼€å‘ç¯å¢ƒï¼Œä»è€Œè§£æ”¾äº†å¼€å‘äººå‘˜ä»¥ä¾¿ä»–ä»¬ä¸“æ³¨åœ¨çœŸæ­£é‡è¦çš„äº‹æƒ…ä¸Šï¼Œæ„å»ºæ°å‡ºçš„è½¯ä»¶ã€‚
ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œä½¿ç”¨å®¹å™¨ï¼ŒæŠŠè‡ªå·±çš„åº”ç”¨æ”¾å…¥å®¹å™¨ã€‚å®¹å™¨è¿˜å¯ä»¥è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€å¤åˆ¶ã€åˆ†äº«ã€ä¿®æ”¹ï¼Œå°±åƒç®¡ç†æ™®é€šçš„ä»£ç ä¸€æ ·ã€‚

## 1: sudo yum install -y yum-utils #å®‰è£… yum-utilsï¼Œå› ä¸º utils æä¾›äº† yum-config-manager èƒ½åŠ›

## 2: sudo  yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo #å®‰è£…å›½å†…çš„ä»“åº“ä¿è¯æˆ‘ä»¬åç»­ä¸‹è½½ docker ä¸­çš„å„ä¸ªåº”ç”¨å¯ä»¥å¿«é€Ÿæ‰§è¡Œï¼Œå› ä¸ºä»å›½å¤–çš„é•œåƒä¸‹è½½å®åœ¨å¤ªæ…¢äº†

## 3: sudo yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin

# reload docker
systemctl restart docker.service


# å®‰è£…æœ€æ–°çš„ docker engine
$ sudo systemctl start docker

# å¯åŠ¨ docker

$ sudo docker run hello-world

# è¿è¡Œ docker çš„ hello-world çš„é•œåƒè¿›è¡Œæµ‹è¯•

å‡ºç°ï¼š
Hello from Docker!
This message shows that your installation appears to be working correctly.

# å®‰è£…  docker-compose

1:curl -L https://get.daocloud.io/docker/compose/releases/download/v2.15.1/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose
2:sudo chmod +x /usr/local/bin/docker-compose
3:$ docker-compose --version

è¾“å‡ºï¼š
docker-compose version 1.25.1, build a82fef07

å‚è€ƒç½‘ç«™:https://www.kongzid.com/archives/docker10

# æŸ¥çœ‹é•œåƒ
docker images

## åˆ é™¤é•œåƒï¼šåˆ é™¤ä¹‹å‰è¦åœæ­¢å®¹å™¨ï¼ï¼ï¼ï¼
docker rmi test-build-docker
docker rmi  2f232153cc95       //  2f232153cc95æ˜¯   IMAGE ID
669513347104

# å¹²æ‰å¯¹åº”å®¹å™¨
docker rm å®¹å™¨ ID(æˆ–å®¹å™¨åç§°)CONTAINER ID 



#  docker pé•œåƒ   name æ˜¯å®¹å™¨
 docker ps -a

1:åœæ­¢è¿è¡Œé•œåƒ docker stop CONTAINER ID

ä½¿ç”¨ inspect å‘½ä»¤å¯ä»¥è·å–é•œåƒçš„è¯¦ç»†ä¿¡æ¯
docker inspect é•œåƒå docker_project/node-web-app //é»˜è®¤ node-web-app

https://www.cnblogs.com/zhaobowen/p/13337441.html


# 111  åœ¨æœ‰dockerfileæ–‡ä»¶çš„åœ°å€æ‰“åŒ…é•œåƒ

docker build -t robot .    //robotæ˜¯åç§° robotæ˜¯RESPOSITOYRY

//! NPM INSTALL é—®é¢˜éœ€è¦åˆ é™¤ package.local.json

# 2222222  åŠ ä¸Štag   robotæ˜¯RESPOSITOYRY
docker tag robot robot:v2

build å‘½ä»¤ç”¨æ¥åˆ¶ä½œé•œåƒï¼Œ-t æ˜¯ç»™é•œåƒæ‰“æ ‡ç­¾ï¼Œ-f å‚æ•°æ˜¯æŒ‡å®š Dockerfile è·¯å¾„ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯é»˜è®¤ Dockerfile åç§°ï¼Œ
æ‰€ä»¥å¯ä»¥ä¸åŒå¡«å†™è¯¥å‚æ•°ã€‚æœ€åä¸€ä¸ª.ä¹Ÿä¸è¦çœç•¥ï¼Œè¡¨ç¤º Dockerfile æ–‡ä»¶çš„æ‰€åœ¨ç›®å½•, ä»£è¡¨æ˜¯å½“å‰è·¯å¾„ï¼Œ

# 222222 é€šè¿‡é•œåƒ dockerstudy åˆ›å»ºä¸€ä¸ªå®¹å™¨å¹¶è¿è¡Œã€‚
docker å®¹å™¨å¼€æœºè‡ªå¯åŠ¨:sudo docker run --net host -itd --name robot --restart=always --privileged -v /dev:/dev 116.62.202.42:5001/robot_amd_v4 /sbin/ini

# 333333 
å‘½ä»¤ï¼šï¼šï¼š docker run --name dockercontainer -d -p 3000:3000 robot
docker run --name robotnamerouteï¼ˆå®¹å™¨åç§°è‡ªå–ï¼‰ -d -p 3002:3002 robotï¼ˆé•œåƒåç§°ï¼‰


è¿”å› 35e1181e650c70f6b1de75a0ed62e3a007699a6733c13a3e47496eb12d0dc115

è·Ÿè¸ªæŸ¥çœ‹å®¹å™¨ dockercontainer çš„æ—¥å¿—è¾“å‡ºï¼šdocker logs -f dockercontainer


æŸ¥çœ‹å®¹å™¨æ—¶é—´
docker exec -u 0 -it bead089df688ï¼ˆå®¹å™¨ID ä¸æ˜¯é•œåƒï¼‰ /bin/bash




# ä¼˜é›…éƒ¨ç½²æ–¹å¼DockerCompose     docker-compose.yml















FROM node:14.17.0

# add mirrors

# RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g' /etc/apk/repositories

# RUN apk --update add tzdata \

# && cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \

# && echo "Asia/Shanghai" > /etc/timezone \

# && apk del tzdata

# RUN mkdir -p /usr/src/app

# åœ¨å®¹å™¨ä¸­åˆ›å»ºä¸€ä¸ªç›®å½•

RUN mkdir -p /usr/src/nodejs/

# ä¸‹ä¸€æ­¥åœ¨é•œåƒä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å­˜æ”¾åº”ç”¨ç¨‹åºä»£ç ï¼Œè¿™å°†æ˜¯ä½ çš„åº”ç”¨ç¨‹åºå·¥ä½œç›®å½•ï¼š

WORKDIR /usr/src/nodejs/

# add npm package

# COPY å‘½ä»¤ç”¨äºå°†å®¿ä¸»æœºå™¨ä¸Šçš„çš„æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒå†…ï¼Œ

# å¦‚æœç›®çš„ä½ç½®ä¸å­˜åœ¨ï¼ŒDocker ä¼šè‡ªåŠ¨åˆ›å»ºã€‚ä½†å®¿ä¸»æœºå™¨ç”¨è¦å¤åˆ¶çš„ç›®å½•å¿…é¡»æ˜¯å’Œ Dockerfile æ–‡ä»¶ç»Ÿè®¡ç›®å½•ä¸‹ã€‚

COPY package.json /usr/src/app/package.json

# ä¸åŒæœåŠ¡å™¨ä¸åŒå¤„ç†ï¼ï¼ï¼ï¼

RUN cd /usr/src/app/
RUN npm install

# RUN npm install --production -d --registry=http://ssr-feiniu01.dev1.fn:8080

# copy code

# æŠŠå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ° Image(é•œåƒ) çš„ /usr/src/nodejs/ ç›®å½•ä¸‹

COPY . /usr/src/nodejs/

EXPOSE 3000

CMD npm start



# nginx é…ç½®ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼

server
    {
        listen 888;
        server_name phpmyadmin;
        index index.html index.htm index.php;
        root  /www/server/phpmyadmin;
            location ~ /tmp/ {
                return 403;
            }

        #error_page   404   /404.html;
        include enable-php.conf;

        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
        {
            expires      30d;
        }

        location ~ .*\.(js|css)?$
        {
            expires      12h;
        }

        location ~ /\.
        {
            deny all;
        }

        access_log  /www/wwwlogs/access.log;
    }
    
server {
  listen 8081;
  server_name 129.211.219.138;
  
  location / {
    root   /www/wwwroot/dist;
    try_files $uri $uri/ @router; # é…ç½®ä½¿ç”¨è·¯ç”±
    index  index.html index.htm;
  }
  
  location /prod-api/ {
    proxy_set_header Host $http_host;
    proxy_set_header X-Real-IP &remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header REMOTE-HOST $remote_addr;
    proxy_pass http://129.211.219.138:8080/;
  }
  
  location /profile/ {
    proxy_set_header Host $http_host;
    proxy_set_header X-Real-IP &remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header REMOTE-HOST $remote_addr;
    proxy_pass http://129.211.219.138:8080/profile/;
  }
  
   # è·¯ç”±é…ç½®ä¿¡æ¯
   location @router {
     rewrite ^.*$ /index.html last;
   }
}

server {
  listen 80;
  server_name 129.211.219.138;
  
  location / {
    root   /www/wwwroot/competition;
    try_files $uri $uri/ @router; # é…ç½®ä½¿ç”¨è·¯ç”±
    index  index.html index.htm;
  }
  
   # è·¯ç”±é…ç½®ä¿¡æ¯
   location @router {
     rewrite ^.*$ /index.html last;
   }
}

include /www/server/panel/vhost/nginx/*.conf;
}